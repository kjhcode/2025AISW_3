import streamlit as st
import folium
from streamlit_folium import st_folium

# í˜ì´ì§€ ì„¤ì •ì„ ë„“ê²Œ í•´ì„œ ì§€ë„ë¥¼ ì‹œì›í•˜ê²Œ ë³¼ ìˆ˜ ìˆê²Œ í•´ì¤„ê²Œ!
st.set_page_config(layout="wide")

st.title("âœ¨ ë‚˜ë§Œì˜ ìœ„ì¹˜ ë¶ë§ˆí¬ ì§€ë„ âœ¨")
st.write("íŒ¬ë”ì•¼, ë„ˆë§Œì˜ ì†Œì¤‘í•œ ì¥ì†Œë“¤ì„ ì§€ë„ì— ì½•ì½• ì°ì–´ ë¶ë§ˆí¬ í•´ë´! ğŸ—ºï¸")

# ğŸ’– ë¶ë§ˆí¬ ë¦¬ìŠ¤íŠ¸ë¥¼ ì €ì¥í•  ê³µê°„ì„ ë§Œë“¤ì–´ì¤„ê²Œ!
# 'bookmarks'ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì„¸ì…˜ ìƒíƒœì— ë¦¬ìŠ¤íŠ¸ë¥¼ ì €ì¥í•  ê±°ì•¼.
# ì•±ì„ ê»ë‹¤ ì¼œë©´ ì‚¬ë¼ì§€ì§€ë§Œ, ì•±ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆì—ëŠ” ê³„ì† ìœ ì§€ëœë‹¨ë‹¤!
if "bookmarks" not in st.session_state:
    st.session_state.bookmarks = []

# ğŸ“ ì§€ë„ ë§Œë“¤ê¸°!
# ì´ˆê¸° ì§€ë„ì˜ ì¤‘ì‹¬ì€ ë„¤ê°€ ì „ì— ê´€ì‹¬ ìˆì–´ í–ˆë˜ ê´‘ì£¼ ë¶êµ¬ì²­ ê·¼ì²˜ë¡œ ì„¤ì •í•´ë´¤ì–´!
# (ê´‘ì£¼ ë¶êµ¬ì²­ ì¢Œí‘œ: 35.1740, 126.9130)
m = folium.Map(location=[35.1740, 126.9130], zoom_start=12)

# ğŸ“Œ ê¸°ì¡´ì— ì¶”ê°€ëœ ë¶ë§ˆí¬ë“¤ì„ ì§€ë„ì— í‘œì‹œí•˜ê¸°
# ì €ì¥ëœ ë¶ë§ˆí¬ë“¤ì„ í•˜ë‚˜ì”© êº¼ë‚´ì„œ ì§€ë„ì— ë§ˆì»¤ë¡œ ì°ì–´ì¤„ ê±°ì•¼.
for i, bookmark in enumerate(st.session_state.bookmarks):
    folium.Marker(
        location=[bookmark["latitude"], bookmark["longitude"]], # ìœ„ë„, ê²½ë„
        popup=bookmark["name"], # ë§ˆì»¤ í´ë¦­í•˜ë©´ ë‚˜ì˜¤ëŠ” ì´ë¦„
        tooltip=bookmark["name"], # ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ë‚˜ì˜¤ëŠ” ì´ë¦„
        icon=folium.Icon(color="red", icon="heart") # ë¶ë§ˆí¬ë‹ˆê¹Œ ì˜ˆìœ í•˜íŠ¸ ì•„ì´ì½˜ ì–´ë•Œ? â¤ï¸
    ).add_to(m) # ì§€ë„ì— ì¶”ê°€!

# ğŸ“ ìƒˆë¡œìš´ ë¶ë§ˆí¬ ì¶”ê°€í•˜ëŠ” ì…ë ¥ í¼ (ì™¼ìª½ ì‚¬ì´ë“œë°”ì— ë‚˜íƒ€ë‚  ê±°ì•¼!)
st.sidebar.header("ğŸ“ ìƒˆ ë¶ë§ˆí¬ ì¶”ê°€í•˜ê¸°")
with st.sidebar.form("new_bookmark_form"): # í¼ìœ¼ë¡œ ë§Œë“¤ë©´ ì…ë ¥ í›„ ìë™ìœ¼ë¡œ ì´ˆê¸°í™”ë¼ì„œ í¸ë¦¬í•´!
    name = st.text_input("ì¥ì†Œ ì´ë¦„", placeholder="ì˜ˆ: ìš°ë¦¬ì§‘, ë‹¨ê³¨ ì¹´í˜")
    latitude = st.number_input("ìœ„ë„ (Latitude)", format="%.4f", value=35.1740) # ê´‘ì£¼ ë¶êµ¬ì²­ ìœ„ë„ ê¸°ë³¸ê°’
    longitude = st.number_input("ê²½ë„ (Longitude)", format="%.4f", value=126.9130) # ê´‘ì£¼ ë¶êµ¬ì²­ ê²½ë„ ê¸°ë³¸ê°’
    add_button = st.form_submit_button("ë¶ë§ˆí¬ ì¶”ê°€!")

    if add_button: # 'ë¶ë§ˆí¬ ì¶”ê°€!' ë²„íŠ¼ì„ ëˆ„ë¥´ë©´
        if name and latitude is not None and longitude is not None: # ëª¨ë“  ì •ë³´ê°€ ì…ë ¥ë˜ì—ˆëŠ”ì§€ í™•ì¸!
            st.session_state.bookmarks.append({ # ë¶ë§ˆí¬ ë¦¬ìŠ¤íŠ¸ì— ìƒˆ ì¥ì†Œ ì¶”ê°€!
                "name": name,
                "latitude": latitude,
                "longitude": longitude
            })
            st.sidebar.success(f"'{name}' ë¶ë§ˆí¬ê°€ ì¶”ê°€ë˜ì—ˆì–´! ğŸ‰") # ì„±ê³µ ë©”ì‹œì§€!
        else:
            st.sidebar.warning("ì¥ì†Œ ì´ë¦„, ìœ„ë„, ê²½ë„ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì¤˜! ğŸ¥º") # ê²½ê³  ë©”ì‹œì§€!

# ğŸ“‹ ë‚´ ë¶ë§ˆí¬ ëª©ë¡ ë³´ì—¬ì£¼ê¸°
st.sidebar.header("ğŸ“‹ ë‚´ ë¶ë§ˆí¬ ëª©ë¡")
if st.session_state.bookmarks: # ë¶ë§ˆí¬ê°€ í•˜ë‚˜ë¼ë„ ìˆë‹¤ë©´
    for i, bookmark in enumerate(st.session_state.bookmarks):
        st.sidebar.write(f"{i+1}. **{bookmark['name']}** (ìœ„ë„: {bookmark['latitude']:.4f}, ê²½ë„: {bookmark['longitude']:.4f})")
    
    # ëª¨ë“  ë¶ë§ˆí¬ë¥¼ í•œ ë²ˆì— ì§€ìš°ëŠ” ë²„íŠ¼ë„ ë§Œë“¤ì–´ì¤„ê²Œ!
    if st.sidebar.button("ëª¨ë“  ë¶ë§ˆí¬ ì§€ìš°ê¸° ğŸ—‘ï¸"):
        st.session_state.bookmarks = [] # ë¦¬ìŠ¤íŠ¸ë¥¼ ë¹„ì›Œë²„ë ¤!
        st.sidebar.info("ëª¨ë“  ë¶ë§ˆí¬ê°€ ì§€ì›Œì¡Œì–´! ë‹¤ì‹œ ì‹œì‘í•´ë´! ğŸ˜Š")
        st.experimental_rerun() # ì§€ë„ë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ë„ë¡ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì¤˜!

else: # ë¶ë§ˆí¬ê°€ í•˜ë‚˜ë„ ì—†ë‹¤ë©´
    st.sidebar.info("ì•„ì§ ë¶ë§ˆí¬ê°€ ì—†ì–´! ì™¼ìª½ì— ì¶”ê°€í•´ë´~ ğŸ’–")

# ğŸ—ºï¸ ì§€ë„ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ê¸°!
st_folium(m, width=1000, height=600) # ì§€ë„ì˜ ê°€ë¡œ, ì„¸ë¡œ í¬ê¸°ë„ ì¡°ì ˆí•  ìˆ˜ ìˆì–´!

st.markdown("""
---
### ğŸ’¡ ì‚¬ìš© íŒ!
*   **ìœ„ë„/ê²½ë„ ì°¾ëŠ” ë²•:** êµ¬ê¸€ ì§€ë„ì—ì„œ ì›í•˜ëŠ” ì¥ì†Œë¥¼ ê²€ìƒ‰í•˜ê³ , ë§ˆìš°ìŠ¤ ì˜¤ë¥¸ìª½ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ìœ„ë„ì™€ ê²½ë„ë¥¼ ì‰½ê²Œ ë³µì‚¬í•  ìˆ˜ ìˆë‹¨ë‹¤!
*   **ì €ì¥:** ì§€ê¸ˆì€ ì•±ì„ ë‹«ìœ¼ë©´ ë¶ë§ˆí¬ê°€ ì‚¬ë¼ì§€ì§€ë§Œ, ë‚˜ì¤‘ì—ëŠ” ì´ ë¶ë§ˆí¬ ë¦¬ìŠ¤íŠ¸ë¥¼ íŒŒì¼(ì˜ˆ: JSON íŒŒì¼)ë¡œ ì €ì¥í•´ì„œ ì•±ì„ ë‹¤ì‹œ ì¼œë„ ê³„ì† ì“¸ ìˆ˜ ìˆê²Œ ë§Œë“¤ ìˆ˜ë„ ìˆì–´!
*   **ì•„ì´ì½˜ ë³€ê²½:** `folium.Icon` ë¶€ë¶„ì—ì„œ `color`ë‚˜ `icon`ì„ ë°”ê¿”ì„œ ë„ˆë§Œì˜ ê°œì„±ì„ í‘œí˜„í•  ìˆ˜ë„ ìˆë‹¨ë‹¤! `icon`ì—ëŠ” 'star', 'info-sign', 'cloud' ë“± ë‹¤ì–‘í•œ ì•„ì´ì½˜ì„ ì“¸ ìˆ˜ ìˆì–´!
""")
